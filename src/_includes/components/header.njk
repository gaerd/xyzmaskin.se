<header class="sticky top-0 z-50 backdrop-blur bg-white/50 border-b border-slate-200 shadow-sm">
  <div class="max-w-7xl mx-auto flex items-center justify-between gap-4 px-4 py-3">
    <a href="/" class="flex items-center gap-3 text-brand font-semibold tracking-wide">
      <img src="/assets/images/logo.png" alt="{{ site.name }}" class="h-6 w-auto invert opacity-75" loading="lazy" decoding="async"/>
    </a>
    <div class="flex items-center gap-3 md:gap-6">
      <nav class="hidden items-center gap-6 text-sm text-slate-600 md:flex">
        <a href="/" class="transition hover:text-brand">Hem</a>
        <a href="/om-oss/" class="transition hover:text-brand">Om oss</a>
        <a href="/kopvillkor/" class="transition hover:text-brand">K&ouml;pvillkor</a>
        <a href="/service-bokning/" class="transition hover:text-brand">Servicebokning</a>
      </nav>
      <details class="group relative text-xs text-slate-700 md:text-sm" data-opening-hours>
        <summary class="flex cursor-pointer select-none items-center gap-2 font-semibold text-brand list-none">
          <span data-opening-hours-summary>&Ouml;ppettider</span>
          <svg class="h-4 w-4 text-brand transition-transform duration-200 group-open:rotate-180" aria-hidden="true" viewBox="0 0 20 20" fill="currentColor">
            <path d="M5.23 7.21a.75.75 0 0 1 1.06.02L10 10.94l3.71-3.7a.75.75 0 0 1 1.06 1.06l-4.24 4.24a.75.75 0 0 1-1.06 0L5.21 8.29a.75.75 0 0 1 .02-1.08z"/>
          </svg>
        </summary>
        <div class="absolute right-0 top-full z-50 mt-2 hidden min-w-[220px] rounded-lg border border-slate-200 bg-white/95 p-4 text-left shadow-lg backdrop-blur group-open:block">
          <p class="mb-2 text-xs font-medium uppercase tracking-wide text-center text-slate-500">Veckans &Ouml;ppettider</p>
          <ul class="space-y-1">
            {% for day in openingHours %}
              <li class="flex items-center justify-between rounded px-2 py-1 text-slate-600" data-weekday="{{ day.weekday }}" data-open="{{ day.open or '' }}" data-close="{{ day.close or '' }}">
                <span class="font-medium" data-opening-label>{{ day.label }}</span>
                <span>
                  {% if day.open and day.close %}
                    {{ day.open }}-{{ day.close }}
                  {% else %}
                    St&auml;ngt
                  {% endif %}
                </span>
              </li>
            {% endfor %}
          </ul>
        </div>
      </details>
    </div>
  </div>
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      var container = document.querySelector('[data-opening-hours]');
      if (!container) {
        return;
      }

      var summaryEl = container.querySelector('[data-opening-hours-summary]');
      if (!summaryEl) {
        return;
      }

      var listItems = container.querySelectorAll('[data-weekday]');
      if (!listItems.length) {
        return;
      }

      var formatTime = function (value) {
        if (!value) {
          return '';
        }
        var parts = value.split(':');
        if (parts.length !== 2) {
          return value;
        }
        var hour = parts[0].startsWith('0')
          ? parts[0].slice(1)
          : parts[0];
        var minute = parts[1];
        return minute === '00'
          ? hour
          : hour + ':' + minute;
      };

      var hours = Array
        .prototype
        .map
        .call(listItems, function (item) {
          var labelEl = item.querySelector('[data-opening-label]');
          return {
            weekday: Number(item.getAttribute('data-weekday')),
            label: labelEl
              ? labelEl
                .textContent
                .trim()
              : '',
            open: item.getAttribute('data-open') || null,
            close: item.getAttribute('data-close') || null
          };
        });

      if (!hours.length) {
        return;
      }

      var todayIndex = new Date().getDay();
      var today = hours.find(function (item) {
        return item.weekday === todayIndex;
      });
      if (!today) {
        return;
      }

      var isOpenToday = today.open && today.close;
      summaryEl.textContent = isOpenToday
        ? '\u00d6ppet idag ' + formatTime(today.open) + '-' + formatTime(today.close)
        : 'St\u00e4ngt idag';

      listItems.forEach(function (item) {
        if (Number(item.getAttribute('data-weekday')) === todayIndex) {
          item
            .classList
            .add('bg-brand/10', 'text-brand', 'font-semibold');
        }
      });
    });
  </script>
</header>
